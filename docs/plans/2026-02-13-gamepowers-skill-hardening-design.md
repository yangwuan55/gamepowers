# GamePowers Skills 硬化设计（严格流程型）

## 1. 背景问题
当前多数技能描述偏简，缺少稳定执行所需的强约束结构，主要风险：
- 输入不完整时没有统一处理，输出不稳定。
- Skill 间边界不清，易出现重复编写和冲突结论。
- 文档树组织与任务映射关系不够显式，影响交接实现。

## 2. 目标
将 14 个专业 skill 升级为严格流程型规范，满足：
- 产出稳定可复现。
- 角色边界明确、冲突可仲裁。
- 文档树组织合理，且与 bd 任务追溯一致。

## 3. 分层模型（方案 2）

### 3.1 协调层
- `game-design-orchestrator`
- `design-handoff-to-superpowers`

职责：
- 阶段编排、路由、门禁、交接。
- 文档树索引与任务映射一致性校验。

### 3.2 架构层
- `ecs-architecture-designer`

职责：
- ECS 技术约束与否决权。
- 调度/事件流/性能预算的硬校验。

### 3.3 领域层
其余 11 个领域 skill。

职责：
- 产生领域设计工件。
- 遵守输入契约、质量门禁、风险控制、追溯规则。

## 4. 文档树治理
采用固定分层结构：
- `docs/gamepowers/index/`：索引、映射、治理规则。
- `docs/gamepowers/domains/<domain>/`：领域主文档（后续逐步迁移）。
- `docs/gamepowers/cross-cutting/`：跨域约束（ECS、经济、平衡、埋点、风控）。
- `docs/gamepowers/tasks/`：任务清单。
- `docs/gamepowers/handoffs/`：交接包。
- `docs/gamepowers/adr/`：冲突决策记录。

短期兼容当前目录结构（`gameplay/levels/...`），通过索引文件维护映射。

## 5. Skill 防冲突治理
每个 skill 必须遵守：
1. 单一主写原则：一个文档只能有一个 `owner_skill`。
2. 其他 skill 仅可写建议区/审查区，不可覆盖主结论。
3. 冲突必须记录 ADR，并由协调层仲裁。
4. 技术冲突由 `ecs-architecture-designer` 拥有最终否决权。

## 6. 模板规范

### 6.1 协调层模板（强流程）
- 适用条件
- 阶段状态机
- 输入契约
- 路由规则
- 阶段门禁
- 文档索引更新规则
- bd 同步规则
- 冲突仲裁与升级
- 反模式
- 完成判定

### 6.2 架构层模板（ECS 强约束）
- 适用条件
- 输入契约
- ECS 设计流程（实体->组件->系统->调度->事件->性能）
- 强制校验清单
- 输出模板
- 禁止项
- 验证与回滚
- 与协调层联动

### 6.3 领域层模板（专业流程）
- 适用条件
- 输入契约
- 设计步骤（每步完成定义）
- 输出工件清单
- 质量门禁
- 风险与缓解
- 与 ECS/协调层联动
- 反模式
- 完成判定

## 7. 统一硬约束（全部 skill）
- 主叙述与输出模板使用中文。
- 输入缺失时一次只问一个问题。
- 必须声明失败处理与升级路径。
- 必须声明与 `task-doc-map.yaml` 和 `bd` 的联动规则。

## 8. 交付物
- 改造后的 14 个 `skills/*/SKILL.md`。
- `docs/gamepowers/index/skill-governance.md`（治理总规）。
- `docs/gamepowers/index/skill-doc-ownership.yaml`（文档归属与审查关系）。

## 9. 验收标准
- 14 个 skill 全部包含对应模板章节。
- 任一 skill 不再存在“只列目标和输出”的弱描述。
- 治理文件可用于解释“谁写、谁审、冲突怎么处理”。
- 校验脚本可自动检查关键章节是否存在。
