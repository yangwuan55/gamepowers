---
name: telemetry-kpi-designer
description: Use when 需要设计埋点与 KPI 体系，支持可观测、诊断与运营决策闭环
---

# 埋点与 KPI 设计（严格流程）

## 适用条件
- 需要定义关键行为事件、指标口径、告警与归因策略。
- 需要把设计目标转为可观测数据闭环。

## 输入契约
必填输入：
- 核心循环与机制文档。
- 经济、活动、反作弊侧重点与监控目标。
- 数据延迟和采样成本约束。

可选输入：
- 历史埋点字典、BI 报表、事件质量问题清单。

输入缺失处理：一次只问一个问题，不并发追问。

## 设计步骤
1. 指标树定义：定义北极星指标、一级指标与诊断指标。
完成定义：指标层级完整且口径无冲突。
2. 事件模型设计：定义事件名、属性、触发时机与采样策略。
完成定义：每个关键指标都有可追溯事件来源。
3. 告警策略制定：定义阈值、窗口与告警分级。
完成定义：异常触发后有明确处理路径。
4. 归因链路设计：定义指标异常到玩法/经济/活动的归因路径。
完成定义：关键异常可在限定时间内定位来源。
5. 执行映射固化：将埋点与监控任务映射到实现计划。
完成定义：任务具备文档引用、依赖和验收项。

## 输出工件
- 主文档：`docs/gamepowers/telemetry/kpi-and-events.md`
- 审查输入：`docs/gamepowers/gameplay/core-loop-spec.md`（建议区）
- 任务映射证据：`docs/gamepowers/index/task-doc-map.yaml`

## 质量门禁
- 指标树、事件模型、告警策略、归因链路齐备。
- 指标口径唯一，禁止同名多义。
- 监控任务可同步到 `bd` 且可验收。

## 风险与缓解
- 风险：埋点口径漂移导致决策误判。
缓解：锁定事件命名规范并建立版本化字典。
- 风险：采样过高影响性能或成本。
缓解：分级采样并与 ECS 性能预算联审。

## 与 ECS/协调层联动
- 埋点实现任务统一标记 `architecture: ECS` 并关联事件流文档。
- 与 `ecs-architecture-designer` 对齐采样时机、事件总线和性能预算。
- 由 `game-design-orchestrator` 统一同步监控任务到 `task-doc-map.yaml` 与 `bd`。

## 反模式（禁止）
- 只列 KPI 名称，不定义口径和触发规则。
- 在多个文档定义同一事件的不同语义。
- 未设计告警处理就推进交接。

## 完成判定
- 指标与事件定义可直接用于实现和分析。
- 告警与归因链路可执行。
- 与 ECS 与任务映射链路一致。
